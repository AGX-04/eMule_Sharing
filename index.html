<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>eMule 分享 - AGX-04 归档 (调试)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify/themes/vue.css" />
  <style>
    /* 简单的调试样式：确保侧边栏在初始时子项是隐藏的 */
    .sidebar-nav > ul > li > ul {
        /* This is docsify-sidebar-collapse plugin's default behavior,
           but adding it here for visual confirmation if plugin fails to apply. */
        display: none; 
    }
    .sidebar-nav > ul > li.active > ul,
    .sidebar-nav > ul > li.open > ul { /* 'open' is a class the plugin might add */
        display: block;
    }
    /* 确保图标有空间 */
    .sidebar-nav li > a {
        position: relative;
    }
    .sidebar-nav .sidebar-toggle-icon { /* This is the class docsify-sidebar-collapse uses for icons */
        position: absolute;
        right: 8px; /* Adjust as needed */
        top: 50%;
        transform: translateY(-50%);
        font-size: 0.8em;
        font-weight: bold;
        color: #999;
        cursor: pointer; /* Ensure it's clickable */
    }
  </style>
</head>
<body>
  <div id="app">加载中...</div>

  <script>
    // --- Docsify 配置 ---
    window.$docsify = {
      name: 'eMule 分享',
      repo: 'AGX-04/eMule_Sharing',
      loadSidebar: true,
      subMaxLevel: 4, // 确保所有层级都被渲染

      // Docsify-sidebar-collapse 插件配置
      sidebarCollapse: {
        accordion: false,
        // 这里使用插件默认的图标，或者你可以继续用 '-' 和 '+' 覆盖。
        // 但为了调试，我们先看插件是否能正常显示其自带的图标。
        // collapseIcon: '-', // Optional: Your custom collapse icon
        // expandIcon: '+'    // Optional: Your custom expand icon
      },

      // --- 关键调试钩子 ---
      // 这个钩子在 Docsify 完成所有内容渲染后触发
      doneEach: function() {
          console.log('--- Docsify doneEach Hook Fired ---');
          console.log('Checking sidebar-nav element...');
          const sidebarNav = document.querySelector('.sidebar-nav');
          if (sidebarNav) {
              console.log('Sidebar nav element found:', sidebarNav);

              // 检查 Docsify 渲染出的 LI 结构
              const allListItems = sidebarNav.querySelectorAll('li');
              console.log(`Total LI elements in sidebar: ${allListItems.length}`);
              
              const parentListItems = sidebarNav.querySelectorAll('li:has(ul)');
              console.log(`LI elements with nested ULs (potential collapsible parents): ${parentListItems.length}`);

              if (parentListItems.length > 0) {
                  console.log('--- Found potential collapsible parents. Checking plugin application ---');
                  parentListItems.forEach(li => {
                      // 检查这些 LI 上是否有插件添加的特定类或元素
                      // docsify-sidebar-collapse 通常会添加 'collapsed' 或 'open' 类，
                      // 并在 <a> 标签内或旁边添加一个带有 'sidebar-toggle-icon' 类的 span。
                      const link = li.querySelector('a');
                      const icon = li.querySelector('.sidebar-toggle-icon'); // 插件添加的图标类

                      console.log(`LI Text: "${li.textContent.trim().split('\n')[0]}"`); // 打印 LI 文本
                      console.log('  Has <a> tag:', !!link);
                      console.log('  Has .sidebar-toggle-icon:', !!icon);
                      console.log('  LI classes:', li.classList.value);
                  });
              } else {
                  console.warn('No LI elements with nested ULs found in sidebar-nav. This indicates _sidebar.md structure might not be correctly interpreted by Docsify for nesting, or subMaxLevel is too low.');
              }
          } else {
              console.warn('Sidebar nav element NOT found. Docsify sidebar might not be rendered.');
          }
      }
    };
  </script>
  <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/docsify-sidebar-collapse.min.js"></script>
  </body>
</html>